# Change axis line
) + scale_x_continuous(labels = scales::percent)
ggplot(ind, aes(x = reorder(Industry, - i_avg), y = i_avg)) + geom_col() + coord_flip() + theme(
# Hide panel borders and remove grid lines
panel.border = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
# Change axis line
)
#Cleaning the data
company_2 <- comp_data_1 %>% select(comp_name, Industry, Percentage_Change_Cap_Jan_Nov)  %>%
mutate(Percentage_Change_Cap_Jan_Nov =as.numeric(gsub("%", "", Percentage_Change_Cap_Jan_Nov))) %>% group_by(Industry)
which(is.na(company_2$Percentage_Change_Cap_Jan_Nov))
gsub("%", "", comp_data_1$Percentage_Change_Cap_Jan_Nov)
company_2$Percentage_Change_Cap_Jan_Nov <- as.numeric(company_2$Percentage_Change_Cap_Jan_Nov)
industry_avg <- aggregate(x = comp_data_2$Percentage_Change_Cap_Jan_Nov, by = list(comp_data_2$Industry),
FUN = mean)
industry_avg <- company_2 %>% group_by(Industry) %>% summarise(i_avg = mean(Percentage_Change_Cap_Jan_Nov))
View(industry_avg)
# Getting the top and bottom performing industries
top_industries <- industry_avg %>% top_n(10)
bottom_industries <- industry_avg %>% top_n(-10)
View(top_industries)
View(bottom_industries)
top_i <- data.frame(top_industries)
bottom_i <- data.frame(bottom_industries)
ind <- rbind(top_industries, bottom_industries)
View(ind)
ggplot(ind, aes(x = reorder(Industry, - i_avg), y = i_avg)) + geom_col() + coord_flip() + theme(
# Hide panel borders and remove grid lines
panel.border = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
# Change axis line
)
ggplot(ind, aes(x = reorder(Industry, - i_avg), y = i_avg)) + geom_col() + coord_flip() + theme(
panel.border = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
) + labs(title = 'Tech wins, hospitality looses')
ggplot(ind, aes(x = reorder(Industry, - i_avg), y = i_avg)) + geom_col() + coord_flip() + theme(
panel.border = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
) + labs(title = 'Tech wins, hospitality looses') + theme(
axis.text.x = element_blank(),
axis.text.y = element_blank(),
axis.ticks = element_blank())
ggplot(ind, aes(x = reorder(Industry, - i_avg), y = i_avg)) + geom_col() + coord_flip() + theme(
panel.border = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
) + labs(title = 'Tech wins, hospitality looses') + theme(
axis.ticks = element_blank())
ggplot(ind, aes(x = reorder(Industry, - i_avg), y = i_avg)) + geom_col() + coord_flip() +
scale_x_continuous(breaks = c(-50,-40,-30,-20,-10,-5,0, 10,20,30,40,50))+
theme(
panel.border = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
) + labs(title = 'Tech wins, hospitality looses') + theme(
axis.ticks = element_blank())
ggplot(ind, aes(x = reorder(Industry, - i_avg), y = i_avg)) + geom_col() + coord_flip() +
theme(
panel.border = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
) + labs(title = 'Tech wins, hospitality looses') + theme(
axis.ticks = element_blank())
ggplot(ind, aes(x = reorder(Industry, - i_avg), y = i_avg)) + geom_col() + coord_flip() +
theme(
panel.border = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
plot.title = element_blank()) + labs(title = 'Tech wins, hospitality looses') + theme(
axis.ticks = element_blank())
ggplot(ind, aes(x = reorder(Industry, - i_avg), y = i_avg)) + geom_col() + coord_flip() +
theme(
panel.border = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
axis.title.x = element_blank()
) + labs(title = 'Tech wins, hospitality looses') + theme(
axis.ticks = element_blank())
ggplot(ind, aes(x = reorder(Industry, - i_avg), y = i_avg)) + geom_col() + coord_flip() +
theme(
panel.border = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
axis.title.y = element_blank()
) + labs(title = 'Tech wins, hospitality looses') + theme(
axis.ticks = element_blank())
ggplot(ind, aes(x = reorder(Industry, - i_avg), y = i_avg)) + geom_col() + coord_flip() +
theme(
panel.border = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
axis.title.y = element_blank()
) + labs(title = 'Tech wins, hospitality looses', subtitle = 'This is the subtitle') + theme(
axis.ticks = element_blank())
top_industries <- industry_avg %>% top_n(5)
bottom_industries <- industry_avg %>% top_n(5)
ggplot(ind, aes(x = reorder(Industry, - i_avg), y = i_avg)) + geom_col() + coord_flip() +
theme(
panel.border = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
axis.title.y = element_blank()
) + labs(title = 'Tech wins, hospitality looses', subtitle = 'This is the subtitle') + theme(
axis.ticks = element_blank())
top_i <- data.frame(top_industries)
bottom_i <- data.frame(bottom_industries)
ind <- rbind(top_industries, bottom_industries)
ggplot(ind, aes(x = reorder(Industry, - i_avg), y = i_avg)) + geom_col() + coord_flip() +
theme(
panel.border = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
axis.title.y = element_blank()
) + labs(title = 'Title', subtitle = 'This is the subtitle') + theme(
axis.ticks = element_blank())
bottom_industries <- industry_avg %>% top_n(-5)
top_i <- data.frame(top_industries)
bottom_i <- data.frame(bottom_industries)
ind <- rbind(top_industries, bottom_industries)
ggplot(ind, aes(x = reorder(Industry, - i_avg), y = i_avg)) + geom_col() + coord_flip() +
theme(
panel.border = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
axis.title.y = element_blank()
) + labs(title = 'Title', subtitle = 'This is the subtitle') + theme(
axis.ticks = element_blank())
ggplot(ind, aes(x = reorder(Industry, - i_avg), y = i_avg)) + geom_col() + coord_flip() +
theme(
panel.border = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
axis.title.y = element_blank()
) + labs(title = 'Title', subtitle = 'This is the subtitle', x = Percentage change in market capitalization) + theme(
ggplot(ind, aes(x = reorder(Industry, - i_avg), y = i_avg)) + geom_col() + coord_flip() +
theme(
panel.border = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
axis.title.y = element_blank()
) + labs(title = 'Title', subtitle = 'This is the subtitle', x = 'Percentage change in market capitalization') + theme(
axis.ticks = element_blank())
ggplot(ind, aes(x = reorder(Industry, - i_avg), y = i_avg)) + geom_col() + coord_flip() +
theme(
panel.border = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
axis.title.y = element_blank()
) + labs(title = 'Title', subtitle = 'This is the subtitle', x = 'Percentage change in market capitalization') + theme(
axis.ticks = element_blank())
ggplot(ind, aes(x = reorder(Industry, - i_avg), y = i_avg)) + geom_col() + coord_flip() +
theme(
panel.border = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
axis.title.y = element_blank()
) + labs(title = 'Title', subtitle = 'This is the subtitle') + theme(
axis.ticks = element_blank())
ggplot(ind, aes(x = reorder(Industry, - i_avg), y = i_avg)) + geom_col() + coord_flip() +
theme(
panel.border = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
axis.title.y = element_blank()
) + labs(title = 'Title', subtitle = 'This is the subtitle')  +
xlab("X") + theme(
axis.ticks = element_blank())
ggplot(ind, aes(x = reorder(Industry, - i_avg), y = i_avg)) + geom_col() + coord_flip() +
theme(
panel.border = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
axis.title.y = element_blank()
) + labs(title = 'Title', subtitle = 'This is the subtitle')  +
+ theme(
axis.ticks = element_blank()) +
theme(plot.title = element_text(hjust = -0.45, vjust=2.12)))
ggplot(ind, aes(x = reorder(Industry, - i_avg), y = i_avg)) + geom_col() + coord_flip() +
theme(
panel.border = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
axis.title.y = element_blank()
) + labs(title = 'Title', subtitle = 'This is the subtitle')  +
+ theme(
axis.ticks = element_blank())
ggplot(ind, aes(x = reorder(Industry, - i_avg), y = i_avg)) + geom_col() + coord_flip() +
theme(
panel.border = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
axis.title.y = element_blank()
) + labs(title = 'Title', subtitle = 'This is the subtitle')  +
+ theme(
axis.ticks = element_blank())
ggplot(ind, aes(x = reorder(Industry, - i_avg), y = i_avg)) + geom_col() + coord_flip() +
theme(
panel.border = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
axis.title.y = element_blank()
) + labs(title = 'Title', subtitle = 'This is the subtitle')  +
xlab("X") + theme(
axis.ticks = element_blank())
ggplot(ind, aes(x = reorder(Industry, - i_avg), y = i_avg)) + geom_col() + coord_flip() +
theme(
panel.border = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
axis.title.y = element_blank()
) + labs(title = 'Title', subtitle = 'This is the subtitle')  +
xlab("X") + theme(
axis.ticks = element_blank()) + geom_text(position = position_dodge(width = .9),    # move to center of bars
vjust = -0.5,    # nudge above top of bar
size = 3) +
ggplot(ind, aes(x = reorder(Industry, - i_avg), y = i_avg)) + geom_col() + coord_flip() +
theme(
panel.border = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
axis.title.y = element_blank()
) + labs(title = 'Title', subtitle = 'This is the subtitle')  +
xlab("X") + theme(
axis.ticks = element_blank())
ggplot(ind, aes(x = reorder(Industry, - i_avg), y = i_avg)) + geom_col() + coord_flip() +
theme(
panel.border = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
axis.title.y = element_blank()
) + labs(title = 'Title', subtitle = 'This is the subtitle')  +
xlab("X") + theme(
ggplot(ind, aes(x = reorder(Industry, - i_avg), y = i_avg)) + geom_col() + coord_flip() +
theme(
panel.border = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
axis.title.y = element_blank()
) + labs(title = 'Title', subtitle = 'This is the subtitle')  +
xlab("X") + theme(
axis.ticks = element_blank())
top_industries <- industry_avg %>% top_n(5)
#Importing company data
comp_data_read.csv("Company_Data_1.csv", encoding="UTF-8",stringsAsFactors=FALSE)
comp_data <- read.csv("data/Comp_4.csv")
View(comp_data_1)
comp_data_1 <- comp_data %>%
rename(
comp_name = X1,
stock_market = X2,
currency = X3,
market_cap = X4,
Revenue = X5,
Percent_Change_Last_Day = X6,
Percent_Change_30_D = X7,
Percent_Change_YTD = X8,
Percent_Change_12M = X9,
Price_Close = X10,
PE_Ratio = X11,
PBV_Ratio = X12,
Industry = X13,
Cap_Start = X14,
Cap_Nov = X15,
Percentage_Change_Cap_Jan_Nov = X16)
#Cleaning the data
company_2 <- comp_data_1 %>% select(comp_name, Industry, Percentage_Change_Cap_Jan_Nov)  %>%
mutate(Percentage_Change_Cap_Jan_Nov =as.numeric(gsub("%", "", Percentage_Change_Cap_Jan_Nov))) %>% group_by(Industry)
which(is.na(company_2$Percentage_Change_Cap_Jan_Nov))
gsub("%", "", comp_data_1$Percentage_Change_Cap_Jan_Nov)
company_2$Percentage_Change_Cap_Jan_Nov <- as.numeric(company_2$Percentage_Change_Cap_Jan_Nov)
industry_avg <- aggregate(x = comp_data_2$Percentage_Change_Cap_Jan_Nov, by = list(comp_data_2$Industry),
FUN = mean)
industry_avg <- company_2 %>% group_by(Industry) %>% summarise(i_avg = mean(Percentage_Change_Cap_Jan_Nov))
View(industry_avg)
# Getting the top and bottom performing industries
top_industries <- industry_avg %>% top_n(5)
bottom_industries <- industry_avg %>% top_n(-5)
View(top_industries)
View(bottom_industries)
top_i <- data.frame(top_industries)
bottom_i <- data.frame(bottom_industries)
ind <- rbind(top_industries, bottom_industries)
View(ind)
ggplot(ind, aes(x = reorder(Industry, - i_avg), y = i_avg)) + geom_col() + coord_flip() +
theme(
panel.border = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
axis.title.y = element_blank()
) + labs(title = 'Title', subtitle = 'This is the subtitle') + theme(
axis.ticks = element_blank())
ggplot(ind, aes(x = reorder(Industry, - i_avg), y = i_avg)) + geom_col() + coord_flip() +
theme(
panel.border = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
axis.title.y = element_blank(),
plot.title = element_text(hjust = 0.5),
plot.subtitle = element_text(hjust = 0.5)
) + labs(title = 'Title', subtitle = 'This is the subtitle') + theme(
axis.ticks = element_blank())
ggplot(ind, aes(x = reorder(Industry, - i_avg), y = i_avg)) + geom_col() + coord_flip() +
theme(
panel.border = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
axis.title.y = element_blank(),
plot.title = element_text(hjust = -5),
plot.subtitle = element_text(hjust = -5)
) + labs(title = 'Title', subtitle = 'This is the subtitle') + theme(
axis.ticks = element_blank())
ggplot(ind, aes(x = reorder(Industry, - i_avg), y = i_avg)) + geom_col() + coord_flip() +
theme(
panel.border = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
axis.title.y = element_blank(),
plot.title = element_text(hjust = -3),
plot.subtitle = element_text(hjust = -3)
) + labs(title = 'Title', subtitle = 'This is the subtitle') + theme(
axis.ticks = element_blank())
ggplot(ind, aes(x = reorder(Industry, - i_avg), y = i_avg)) + geom_col() + coord_flip() +
theme(
panel.border = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
axis.title.y = element_blank(),
plot.title = element_text(hjust = -2),
plot.subtitle = element_text(hjust = -2)
) + labs(title = 'Title', subtitle = 'This is the subtitle') + theme(
axis.ticks = element_blank())
ggplot(ind, aes(x = reorder(Industry, - i_avg), y = i_avg)) + geom_col() + coord_flip() +
theme(
panel.border = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
axis.title.y = element_blank(),
plot.title = element_text(hjust = -2),
plot.subtitle = element_text(hjust = -2)
) + labs(title = 'Title', subtitle = 'Digital industries win the Covid-19 economy') + theme(
axis.ticks = element_blank())
ggplot(ind, aes(x = reorder(Industry, - i_avg), y = i_avg)) + geom_col() + coord_flip() +
theme(
panel.border = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
axis.title.y = element_blank(),
plot.title = element_text(hjust = -3),
plot.subtitle = element_text(hjust = -2)
) + labs(title = 'Title', subtitle = 'Digital industries win the Covid-19 economy') + theme(
axis.ticks = element_blank())
ggplot(ind, aes(x = reorder(Industry, - i_avg), y = i_avg)) + geom_col() + coord_flip() +
theme(
panel.border = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
axis.title.y = element_blank(),
plot.title = element_text(hjust = -5),
plot.subtitle = element_text(hjust = -2)
) + labs(title = 'Title', subtitle = 'Digital industries win the Covid-19 economy') + theme(
axis.ticks = element_blank())
ggplot(ind, aes(x = reorder(Industry, - i_avg), y = i_avg)) + geom_col() + coord_flip() +
theme(
panel.border = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
axis.title.y = element_blank(),
plot.title = element_text(hjust = -5),
plot.subtitle = element_text(hjust = -5)
) + labs(title = 'Title', subtitle = 'Digital industries win the Covid-19 economy') + theme(
axis.ticks = element_blank())
ggplot(ind, aes(x = reorder(Industry, - i_avg), y = i_avg)) + geom_col() + coord_flip() +
theme(
panel.border = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
axis.title.y = element_blank(),
plot.title = element_text(hjust = -3),
plot.subtitle = element_text(hjust = -5)
) + labs(title = 'Title', subtitle = 'Digital industries win the Covid-19 economy') + theme(
axis.ticks = element_blank())
ggplot(ind, aes(x = reorder(Industry, - i_avg), y = i_avg)) + geom_col() + coord_flip() +
theme(
panel.border = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
axis.title.y = element_blank(),
plot.title = element_text(hjust = -0.5),
plot.subtitle = element_text(hjust = -5)
) + labs(title = 'Title', subtitle = 'Digital industries win the Covid-19 economy') + theme(
axis.ticks = element_blank())
ggplot(ind, aes(x = reorder(Industry, - i_avg), y = i_avg)) + geom_col() + coord_flip() +
theme(
panel.border = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
axis.title.y = element_blank(),
plot.title = element_text(hjust = -1),
plot.subtitle = element_text(hjust = -5)
) + labs(title = 'Digital industries win the Covid-19 economy', subtitle = 'X') + theme(
axis.ticks = element_blank())
ggplot(ind, aes(x = reorder(Industry, - i_avg), y = i_avg)) + geom_col() + coord_flip() +
theme(
panel.border = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
axis.title.y = element_blank(),
plot.title = element_text(hjust = -3),
plot.subtitle = element_text(hjust = -5)
) + labs(title = 'Digital industries win the Covid-19 economy', subtitle = 'X') + theme(
axis.ticks = element_blank())
ggplot(ind, aes(x = reorder(Industry, - i_avg), y = i_avg)) + geom_col() + coord_flip() +
theme(
panel.border = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
axis.title.y = element_blank(),
plot.title = element_text(hjust = 0),
plot.subtitle = element_text(hjust = -5)
) + labs(title = 'Digital industries win the Covid-19 economy', subtitle = 'X') + theme(
axis.ticks = element_blank())
ggplot(ind, aes(x = reorder(Industry, - i_avg), y = i_avg)) + geom_col() + coord_flip() +
theme(
panel.border = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
axis.title.y = element_blank(),
plot.title = element_text(hjust = 0),
plot.subtitle = element_text(hjust = -5)
) + labs(title = 'X', subtitle = 'X') + theme(
axis.ticks = element_blank())
ggplot(ind, aes(x = reorder(Industry, - i_avg), y = i_avg)) + geom_col() + coord_flip() +
theme(
panel.border = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
axis.title.y = element_blank(),
plot.title = element_text(hjust = 0),
plot.subtitle = element_text(hjust = 0)
) + labs(title = 'Y', subtitle = 'X') + theme(
axis.ticks = element_blank())
top_industries <- industry_avg %>% top_n(10)
bottom_industries <- industry_avg %>% top_n(-10)
View(top_industries)
View(bottom_industries)
top_i <- data.frame(top_industries)
bottom_i <- data.frame(bottom_industries)
ind <- rbind(top_industries, bottom_industries)
ggplot(ind, aes(x = reorder(Industry, - i_avg), y = i_avg)) + geom_col() + coord_flip() +
theme(
panel.border = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
axis.title.y = element_blank(),
plot.title = element_text(hjust = 0),
plot.subtitle = element_text(hjust = 0)
) + labs(title = 'Y', subtitle = 'X') + theme(
axis.ticks = element_blank())
View(comp_data_1)
ggplot(ind, aes(x = reorder(Industry, - i_avg), y = i_avg)) + geom_col() + coord_flip() +
theme(
panel.border = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
axis.title.y = element_blank(),
plot.title = element_text(hjust = 0),
plot.subtitle = element_text(hjust = 0)
) + labs(title = 'Digital industries win the Covid-19 crisis', subtitle = '') + theme(
axis.ticks = element_blank())
read_xls('Sector_Data.xlsx')
read_xls(data/'Sector_Data.xlsx')
read_xls('Sector_Data.xlsx')
read_xls('Sector_Data.xlsx')
read_csv('Sector_Data.csv')
View(SD)
SD <- read_csv('Sector_Data.csv')
View(SD)
SD_1 <- read_xls('Sector_Data.csv')
SD <- read_csv('Sector_Data.csv')
View(SD)
SD_1 <- read_xls('Sector_Data.xlsx')
SD <- rread.csv("data/Sector_Data.csv")
SD <- read.csv("data/Sector_Data.csv")
SD_1 <- read_xls('data/Sector_Data.xlsx')
SD_1 <- read_xls("data/Sector_Data.xlsx")
SD <- read.csv("data/Sector_Data.csv")
SD_1 <- read_xls("data/Sector_Data.xlsx")
library(readxl)
Sector_Data <- read_excel("data/Sector_Data.xlsx")
View(Sector_Data)
View(Sector_Data)
SD <- Sector_Data
SD_09 <- SD %>% select(Sector, 2009)
SD_09 <- SD %>% select(Sector, '2009')
SD_09
library(readxl)
Sector_Data_1 <- read_excel("data/Sector_Data_1.xlsx")
View(Sector_Data_1)
View(Sector_Data_1)
SD <- Sector_Data_1
ggplot(data, aes(fill=Sector, y=Balue, x=Year)) +
geom_bar(position="fill", stat="identity")
ggplot(SD, aes(fill=Sector, y=Balue, x=Year)) +
geom_bar(position="fill", stat="identity")
ggplot(SD, aes(fill=Sector, y=Value, x=Year)) +
geom_bar(position="fill", stat="identity")
